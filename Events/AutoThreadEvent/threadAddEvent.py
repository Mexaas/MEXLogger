import disnake
from disnake.ext import commands
from Database.database import db

class addThreadMessage(commands.Cog):
    def __init__(self, bot):
        self.bot = bot
    channel_ids = [1477014878102356028, 1476962126684749965]
    auto_thread_emojis = [1477235023970042028, 1477235025723392102]

    @commands.Cog.listener()
    async def on_message(self, message):
        if message.author.bot: return
        
        # –ö–∞–Ω–∞–ª –∏–¥–µ–π
        if message.channel.id == self.channel_ids[0]:
            thread = await self.createThread(message, f"–ü—É–±–ª–∏–∫–∞—Ü–∏—è {message.author.display_name}", 1440, self.auto_thread_emojis)
            await db.execute(
                """
                INSERT OR REPLACE INTO threads (thread_id, owner_id, message_id, channel_id)
                VALUES (?, ?, ?, ?)
                """,
                (thread.id, message.author.id, message.id, message.channel.id)
            )
            await db.commit()
        
        # –ö–∞–Ω–∞–ª –Ω–æ–≤–æ—Å—Ç–µ–π
        if message.channel.id == self.channel_ids[1]:
            await self.createThread(message, f"{message.content[-5:]} by {message.author.display_name}", 10080, self.auto_thread_emojis)

    async def createThread(self, message, thread_name: str, archive_duration: int, emoji_list: list) -> disnake.Thread:
        author_message = await message.channel.fetch_message(message.id)
        thread = await author_message.create_thread(
            name=thread_name,
            auto_archive_duration=archive_duration
        )
        for emoji in emoji_list:
            await author_message.add_reaction(self.bot.get_emoji(emoji))
        return thread

def setup(bot):
    bot.add_cog(addThreadMessage(bot))

# # :13201suporte: –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
# - –í—Å–µ—Ö ` –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é `, –Ω–∞ —Å–≤—è–∑–∏ @mexaa_. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç ` 01.03.2026 `

#  ` 1 ` –î–æ–±–∞–≤–ª–µ–Ω—ã **autoThreadEvents**, —Ç–µ–ø–µ—Ä—å –≤–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–≤–∏–≥–∞—é—Ç—Å—è –≤ #üì¨„Ä°–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è. –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–æ—Å—Ç–∞ –≤ –¥–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª - –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –≤–µ—Ç–∫—É –∏ –¥–æ–±–∞–≤–∏—Ç –Ω—É–∂–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏.
# ` 2 ` –î–ª—è –∫–∞–Ω–∞–ª–∞ #üì¨„Ä°–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ ` /remove_thread `, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ —É–¥–∞–ª—è—Ç—å —Å–≤–æ–∏ –≤–µ—Ç–∫–∏ –ø–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω—É–∂–¥–µ.
# ` 3 ` –£–¥–∞–ª–µ–Ω –≤–∏–¥ –∫–∞–ø—á–∏ —Å–æ ` —Å—Ç–µ–ø–µ–Ω—è–º–∏ `.
# ` 4 ` –ù–µ–±–æ–ª—å—à–æ–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞.
# ` 5 ` –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ ` /menu `, –≤ –±—É–¥—É—â–µ–º –±—É–¥–µ—Ç —É–¥–æ–±–Ω–æ–µ select-–º–µ–Ω—é.
# ` 6 ` –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤, —á—Ç–æ–±—ã –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏: ` –æ–Ω–∏ –≤–ø–µ—Ä–≤—ã–µ –Ω–∞–ø–∏—à—É—Ç –≤ —á–∞—Ç—ã `, —Ç–∞–∫–∏–µ –∫–∞–∫: #üí¨„Ä°–æ–±—â–∏–π, #‚òï„Ä°–æ—Ñ—Ñ—Ç–æ–ø, #üì¨„Ä°–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
# ` 7 ` –ü—Ä–∏ –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä - –Ω–æ–≤—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö


# # :python: –ß—Ç–æ –≤ –±—É–¥—É—â–µ–º?
# - –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∏—à–∫–∏, –≤ —Ç–æ–º —á–∏—Å–ª–µ UI –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
# - –î–æ—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –Ω–æ–≤–∏—á–∫–æ–≤ –≤ #üëã„Ä°–Ω–æ–≤—ã–µ
# - –î–æ—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ ` /menu `
# - –î–æ—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã ` –≤–µ—Ç–æ–∫ `

# > –ö–∞–∫ –≤—ã –ø–æ–Ω—è–ª–∏, –≤ –ø—Ä—è–º–æ–º —Å–º—ã—Å–ª–µ —ç—Ç–æ–≥–æ —Å–ª–æ–≤–∞: —Å–µ—Ä–≤–µ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º-—Å–∞–º–æ–ø–∏—Å–Ω–æ–º –±–æ—Ç–µ. –ù–∞ —ç—Ç–æ–º –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–µ –ø–ª–∞–Ω–∏—Ä—É—é, –±—É–¥—É –¥–æ–±–∞–≤–ª—è—Ç—å –≤—Å–µ –±–æ–ª—å—à–µ –∏ –±–æ–ª—å—à–µ —Ä–∞–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –°–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–Ω–µ—Ç –∂–∏–≤–µ–µ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

# 0.1.0